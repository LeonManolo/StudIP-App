image: aljoscha992/studipadawan_flutter_amd64:latest

variables:
  TARGET_BRANCH: "main"

stages:
  - Build

build-apk:
  stage: Build
  script:
    - echo "$KEYSTORE" | base64 --decode >> android/app/upload-keystore.jks
    - echo -e "keyPassword=$STORE_PASSWORD" >> android/key.properties
    - echo -e "storePassword=$STORE_PASSWORD" >> android/key.properties
    - echo -e "keyAlias=studipadawan" >> android/key.properties
    - echo -e "storeFile=upload-keystore.jks" >> android/key.properties
    - flutter build apk
  artifacts:
    paths:
      - build/app/outputs/apk/release/StudIPadawan-1.0.0.apk
